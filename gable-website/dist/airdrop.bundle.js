(()=>{"use strict";let t="https://www.sundaefinance.net:8443";async function e(e){try{const o=await async function(e){const o=`${t}/api/airdrop_data`,n=`account_address=${encodeURIComponent(e)}`;console.log(n);try{const e=await fetch(`${o}?${n}`);if(console.log(e),!e.ok)throw new Error("Failed to fetch supplier airdrop data");const a=await e.json();if(console.log("data.length: ",a.length),0===a.length)throw new Error("Account address not found as supplier");let r;console.log("airdrop user data:",a);const c=`${t}/api/airdropped_data`;try{const t=await fetch(`${c}?${n}`);if(console.log(t),t.ok){const e=await t.json();console.error("data2:",e),r=e.airdropped_amount}else r=0}catch(t){console.error("An error occurred:",t),r=0}const d={date:a[0].date,entity_address:a[0].entity_address,balance_change_unlock:a[0].balance_change_unlock,balance_change_lock:a[0].balance_change_lock,balance_change_sum:a[0].balance_change_sum,airdropped:r,airdrop:a[0].airdrop};return console.log("airdrop user data:",d),console.log("airdropped user data:",r),d}catch(t){throw t}}(e),n=o.entity_address,a=parseFloat(o.balance_change_unlock).toFixed(2),r=parseFloat(o.balance_change_lock).toFixed(2),c=parseFloat(o.balance_change_sum).toFixed(2),d=parseFloat(o.airdropped).toFixed(2),l=parseFloat(o.airdrop).toFixed(2),s=l-d;console.log("airdropped_amount:",d);const i=document.getElementById("account"),u=document.getElementById("lsu-locked"),p=document.getElementById("lsu-unlocked"),g=document.getElementById("lsu-total"),m=document.getElementById("previous-airdrop-amount"),y=document.getElementById("next-airdrop-amount"),h=document.getElementById("airdrop-amount");i.innerText="account_..."+n.substring(n.length-5),u.innerText=parseFloat(r).toLocaleString()+" LSU",p.innerText=parseFloat(a).toLocaleString()+" LSU",g.innerText=parseFloat(c).toLocaleString()+" LSU",m.innerText=parseFloat(d).toLocaleString()+" GAB",y.innerText=parseFloat(s).toLocaleString()+" GAB",h.innerText=parseFloat(l).toLocaleString()+" GAB",console.log("lsuLockedElement:",u)}catch(t){throw t}}async function o(e){const o=`${t}/api/borrower_airdrop_data`,n=`account_address=${encodeURIComponent(e)}`;console.log(n);try{const t=await fetch(`${o}?${n}`);if(console.log(t),!t.ok)throw new Error("Failed to fetch borrower airdrop data");const e=await t.json();if(console.log("data.length: ",e.length),0===e.length)throw new Error("Account address not found as borrower");return console.log("Airdrop borrower response:",e),e}catch(t){throw t}}async function n(t){try{const e=await o(t),n=t,a=e.reduce(((t,e)=>t+e.flashloan_count),0),r=e.reduce(((t,e)=>t+parseFloat(e.flashloan_total)),0).toFixed(2),c=e.reduce(((t,e)=>t+parseFloat(e.airdrop)),0).toFixed(2);console.log("Sum of flashloan_count:",a),console.log("Sum of flashloan_total:",r),console.log("Sum of airdrop:",c);const d=document.getElementById("borrower-account"),l=document.getElementById("flashloan-count"),s=document.getElementById("flashloan-total"),i=document.getElementById("borrower-airdrop-amount");d.innerText="account_..."+n.substring(n.length-5),l.innerText=parseFloat(a).toLocaleString(),s.innerText=parseFloat(r).toLocaleString()+" XRD",i.innerText=parseFloat(c).toLocaleString()+" GAB"}catch(t){throw t}}async function a(e,n,a,d,l){if(!e.startsWith("account_")){const t='Invalid account address. It must start with "account_".';throw r.textContent=t,c.style.display="flex",new Error('Invalid account address. It must start with "account_".')}try{await a(e)}catch(t){return r.textContent=t,void(c.style.display="flex")}document.getElementById(n).style.display="flex",c.style.display="none",await async function(e,n){try{let a,r;"supplier"==n?(a=await async function(e){const o=`${t}/api/airdrop_hist_data`,n=`account_address=${encodeURIComponent(e)}`;console.log(n);try{const t=await fetch(`${o}?${n}`);if(console.log(t),!t.ok)throw new Error("Failed to fetch airdrop data");const e=await t.json();console.log("airdrop data:",e);const a=[];let r=0;for(const t of e){const e=t.date;r+=t.airdrop;const o={date:e,airdrop:r};a.push(o)}return console.log("Processed airdrop data:"),console.log(a),a}catch(t){console.error(t)}}(e),console.log("Airdrop supplier processedData: ",a),r=document.getElementById("chart-airdrop")):(a=await o(e),console.log("Airdrop borrower processedData: ",a),r=document.getElementById("chart-borrower-airdrop"));try{const t=await async function(t){console.log("processedData airdrop data:"),console.log(t);const e=new google.visualization.DataTable;e.addColumn("date","Date"),e.addColumn("number","GAB");for(const[o,n]of Object.entries(t)){const t=new Date(n.date),o=n.airdrop;e.addRow([t,o])}return e}(a);console.log("Airdrop dataTable: ",t),console.log("dataTable:",t);let e={vAxis:{minorGridlines:{count:0},gridlines:{color:"lightgray",opacity:.2},textPosition:"in"},hAxis:{title:"Date",gridlines:{color:"transparent"},format:"yyyy-MM-dd"},backgroundColor:"transparent",colors:["#90a7ac"],chartArea:{width:"85%",height:"80%"},legend:{position:"none"},animation:{duration:500,easing:"linear",startup:!0},pointSize:3},o=new google.visualization.AreaChart(r);o.draw(t,e),window.addEventListener("resize",(function(){o.draw(t,e)}))}catch(t){console.error("Error processing airdrop data:",t)}}catch(t){console.error("Error fetching airdrop data:",t)}}(e,d),document.getElementById(l).classList.add("active")}google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback((function(){!async function(){const e=`${t}/api/airdrop_latest_update`;try{const t=await fetch(`${e}`);if(console.log(t),!t.ok)throw new Error("Failed to fetch airdrop latest update date");const o=await t.json();if(0===o.length)throw new Error("Latest update date not found");console.log("airdrop user data:",o);const n=new Date(o.timestamp).toISOString().slice(0,16).replace("T"," ");document.getElementById("update-date").innerText=n}catch(t){throw t}}()})),n("account_rdx128y22s3r8xs2kl3muy792srj5rh9z79e0zkkjrmvdlqrkzylerzypj"),document.getElementById("airdrop-go").addEventListener("click",(()=>{a(document.getElementById("airdrop-address").value,"content1",(t=>e(t)),"supplier","tabButton1"),document.getElementById("content2").style.display="none",document.getElementById("tabButton2").classList.remove("active")})),document.getElementById("tabButton1").addEventListener("click",(()=>{a(document.getElementById("airdrop-address").value,"content1",(t=>e(t)),"supplier","tabButton1"),document.getElementById("content2").style.display="none",document.getElementById("tabButton2").classList.remove("active")})),document.getElementById("tabButton2").addEventListener("click",(()=>{a(document.getElementById("airdrop-address").value,"content2",(t=>n(t)),"borrower","tabButton2"),document.getElementById("content1").style.display="none",document.getElementById("tabButton1").classList.remove("active")}));const r=document.getElementById("airdrop-error-message"),c=document.getElementById("airdrop-error");document.getElementById("airdrop-error-button").addEventListener("click",(function(){c.style.display="none"}))})();